module.exports=[78476,a=>{"use strict";a.s(["DRAFT_STATUS_MAP",0,{draft:{variant:"default",label:"Draft"},review:{variant:"warning",label:"In Review"},scheduled:{variant:"info",label:"Scheduled"},published:{variant:"success",label:"Published"}},"INTEREST_OPTIONS",0,["Technology","Business","Creator","Marketing","Finance","AI & ML","Design","Startup"],"PLATFORM_META",0,{beehiiv:{label:"Beehiiv",description:"Connect your Beehiiv account to publish directly",color:"bg-amber-500"},substack:{label:"Substack",description:"Publish newsletters to your Substack",color:"bg-orange-500"},kit:{label:"Kit (ConvertKit)",description:"Send newsletters via Kit email platform",color:"bg-blue-500"}},"TIMING",0,{DEBOUNCE_MS:2e3,SAVE_DISPLAY_MS:2e3,RSS_CACHE_SEC:3600}])},26027,a=>{"use strict";var b=a.i(80290);let c={default:"bg-gray-100 text-gray-700",success:"bg-green-100 text-green-700",warning:"bg-amber-100 text-amber-700",info:"bg-blue-100 text-blue-700",purple:"bg-indigo-100 text-indigo-700"};function d({children:a,variant:d="default",className:e=""}){return(0,b.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${c[d]} ${e}`,children:a})}a.s(["default",()=>d])},70947,a=>{"use strict";var b=a.i(6884),c=a.i(48827);function d(){let a=(0,b.useMemo)(()=>(0,c.createBrowserSupabaseClient)(),[]),[d,e]=(0,b.useState)(null),[f,g]=(0,b.useState)(!0);return(0,b.useEffect)(()=>{a.auth.getUser().then(({data:a})=>{e(a.user),g(!1)});let{data:{subscription:b}}=a.auth.onAuthStateChange((a,b)=>{e(b?.user??null)});return()=>b.unsubscribe()},[a]),{supabase:a,user:d,loading:f}}a.s(["useUser",()=>d])},69618,a=>{"use strict";var b=a.i(80290);let c={primary:"bg-gradient-to-r from-indigo-600 to-violet-600 text-white hover:from-indigo-700 hover:to-violet-700 shadow-md shadow-indigo-200 hover:shadow-lg hover:shadow-indigo-300 active:scale-[0.98]",secondary:"bg-white text-gray-700 border border-gray-200 hover:border-indigo-300 hover:text-indigo-600 shadow-sm hover:shadow-md active:scale-[0.98]",ghost:"text-gray-600 hover:text-indigo-600 hover:bg-indigo-50"},d={sm:"px-3.5 py-1.5 text-sm gap-1.5",md:"px-5 py-2.5 text-sm gap-2",lg:"px-7 py-3.5 text-base gap-2"};function e({variant:a="primary",size:e="md",className:f="",children:g,...h}){return(0,b.jsx)("button",{className:`inline-flex items-center justify-center font-semibold rounded-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer ${c[a]} ${d[e]} ${f}`,...h,children:g})}a.s(["default",()=>e])},66725,a=>{"use strict";var b=a.i(80290),c=a.i(6884);function d({isOpen:a,onClose:d,title:e,children:f}){return((0,c.useEffect)(()=>{let b=a=>{"Escape"===a.key&&d()};return a&&(document.addEventListener("keydown",b),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",b),document.body.style.overflow=""}},[a,d]),a)?(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-gray-900/60 backdrop-blur-sm",onClick:d}),(0,b.jsxs)("div",{className:"relative w-full max-w-lg mx-4 bg-white rounded-2xl shadow-2xl border border-gray-200 max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:e}),(0,b.jsx)("button",{onClick:d,className:"p-1.5 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsx)("div",{className:"px-6 py-5",children:f})]})]}):null}a.s(["default",()=>d])},45016,a=>{"use strict";function b(a){let b=new Date(a),c=Math.floor((new Date().getTime()-b.getTime())/36e5);if(c<1)return"Just now";if(c<24)return`${c}h ago`;let d=Math.floor(c/24);return d<7?`${d}d ago`:b.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function c(a){return a&&a.trim()?a.trim().split(/\s+/).filter(Boolean).length:0}a.s(["countWords",()=>c,"formatDate",()=>b])},50276,a=>{"use strict";var b=a.i(80290),c=a.i(6884),d=a.i(4310),e=a.i(69618),f=a.i(26027),g=a.i(66725),h=a.i(70947),i=a.i(78476),j=a.i(45016);function k({draftId:a}){let{draft:k,sourceArticles:l,loading:m,saveStatus:n,debouncedSave:o,updateStatus:p}=function(a){let{supabase:b,user:d}=(0,h.useUser)(),[e,f]=(0,c.useState)(null),[g,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)("idle"),[p,q]=(0,c.useState)(null),r=(0,c.useRef)(void 0),[s,t]=(0,c.useState)(0);(0,c.useEffect)(()=>{if(!d||!a)return;let c=!0;return(async()=>{try{let{data:e,error:g}=await b.from("drafts").select("*").eq("id",a).eq("user_id",d.id).single();if(!c)return;if(g)throw g;e&&f(e);let{data:h}=await b.from("draft_articles").select("*, articles(*)").eq("draft_id",a);if(!c)return;if(h){let a=h.map(a=>a.articles).filter(Boolean);k(a)}q(null)}catch(a){if(!c)return;q(a instanceof Error?a.message:"Failed to load draft")}finally{c&&m(!1)}})(),()=>{c=!1,r.current&&clearTimeout(r.current)}},[b,d,a,s]);let u=(0,c.useCallback)(async c=>{if(!a||!d)return;o("saving");let e=(0,j.countWords)(c);await b.from("drafts").update({content:c,word_count:e}).eq("id",a).eq("user_id",d.id),o("saved"),setTimeout(()=>o("idle"),i.TIMING.SAVE_DISPLAY_MS)},[b,a,d]),v=(0,c.useCallback)(a=>{r.current&&clearTimeout(r.current),r.current=setTimeout(()=>u(a),i.TIMING.DEBOUNCE_MS)},[u]);return{draft:e,sourceArticles:g,loading:l,error:p,saveStatus:n,saveDraft:u,debouncedSave:v,updateStatus:async c=>{d&&(await b.from("drafts").update({status:c}).eq("id",a).eq("user_id",d.id),f(a=>a?{...a,status:c}:null))},refresh:()=>{m(!0),t(a=>a+1)}}}(a),{user:q}=(0,h.useUser)(),r=(0,d.useRouter)(),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)(null);(0,c.useEffect)(()=>{k?.content&&t(k.content)},[k?.content]),(0,c.useEffect)(()=>{k&&s!==k.content&&o(s)},[s,k,o]);let I=async()=>{if(k){x(!0),H(null);try{let a=await fetch("/api/subject-lines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:k.title,content:s})});if(!a.ok){let b=await a.json().catch(()=>({}));H(b.error||"Failed to generate subject lines");return}let b=await a.json();v(b.subjectLines||[]),z(!0)}finally{x(!1)}}},J=async a=>{if(s.trim()){F(a),H(null);try{let b=await fetch("/api/ai-transform",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:a,content:s})});if(!b.ok){let a=await b.json().catch(()=>({}));H(a.error||"AI transformation failed");return}let c=await b.json();"tldr"===a?t(c.result+"\n\n---\n\n"+s):t(c.result)}finally{F(null)}}},K=async a=>{if(q&&k){D(!0),H(null);try{let b=await fetch("/api/publish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({draftId:k.id,platform:a})});if(!b.ok){let a=await b.json().catch(()=>({}));H(a.error||"Failed to publish");return}await p("published"),B(!1),r.push("/dashboard/drafts")}finally{D(!1)}}};return m?(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6 h-[calc(100vh-10rem)]",children:[(0,b.jsx)("div",{className:"flex-1 bg-gray-100 rounded-xl animate-pulse"}),(0,b.jsx)("div",{className:"w-full lg:w-80 bg-gray-100 rounded-xl animate-pulse"})]}):k?(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6 h-[calc(100vh-10rem)]",children:[(0,b.jsxs)("div",{className:"flex-1 flex flex-col bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(f.default,{variant:i.DRAFT_STATUS_MAP[k.status]?.variant||"default",children:i.DRAFT_STATUS_MAP[k.status]?.label||k.status}),(0,b.jsxs)("span",{className:"text-sm text-gray-400",children:[(0,j.countWords)(s)," words"]}),"saving"===n&&(0,b.jsx)("span",{className:"text-xs text-amber-500",children:"Saving..."}),"saved"===n&&(0,b.jsx)("span",{className:"text-xs text-green-500",children:"Saved"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.default,{variant:"ghost",size:"sm",onClick:()=>r.push("/dashboard/drafts"),children:"Back"}),(0,b.jsxs)(e.default,{size:"sm",onClick:()=>B(!0),children:["Publish",(0,b.jsx)("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})]})]}),(0,b.jsx)("textarea",{value:s,onChange:a=>t(a.target.value),className:"flex-1 p-6 text-sm text-gray-800 leading-relaxed resize-none focus:outline-none font-mono",placeholder:"Start writing your newsletter..."})]}),(0,b.jsxs)("div",{className:"w-full lg:w-80 flex flex-col gap-4 shrink-0",children:[(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-4",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"AI Assist"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("button",{onClick:()=>J("rewrite"),disabled:null!==E,className:"w-full flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm text-left hover:bg-indigo-50 text-gray-700 hover:text-indigo-700 transition-colors cursor-pointer disabled:opacity-50",children:[(0,b.jsx)("svg",{className:"w-4 h-4 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"rewrite"===E?"Rewriting...":"Rewrite in my style"]}),(0,b.jsxs)("button",{onClick:()=>J("shorten"),disabled:null!==E,className:"w-full flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm text-left hover:bg-indigo-50 text-gray-700 hover:text-indigo-700 transition-colors cursor-pointer disabled:opacity-50",children:[(0,b.jsx)("svg",{className:"w-4 h-4 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h8m-8 6h16"})}),"shorten"===E?"Shortening...":"Make it shorter"]}),(0,b.jsxs)("button",{onClick:I,disabled:w,className:"w-full flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm text-left hover:bg-indigo-50 text-gray-700 hover:text-indigo-700 transition-colors cursor-pointer disabled:opacity-50",children:[(0,b.jsx)("svg",{className:"w-4 h-4 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),w?"Generating...":"Generate subject lines"]}),(0,b.jsxs)("button",{onClick:()=>J("tldr"),disabled:null!==E,className:"w-full flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm text-left hover:bg-indigo-50 text-gray-700 hover:text-indigo-700 transition-colors cursor-pointer disabled:opacity-50",children:[(0,b.jsx)("svg",{className:"w-4 h-4 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"tldr"===E?"Generating...":"Add TL;DR summary"]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-4 flex-1 overflow-auto",children:[(0,b.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:["Source Articles (",l.length,")"]}),0===l.length?(0,b.jsx)("p",{className:"text-xs text-gray-400",children:"No source articles linked to this draft."}):(0,b.jsx)("div",{className:"space-y-3",children:l.map(a=>(0,b.jsxs)("a",{href:a.source_url,target:"_blank",rel:"noopener noreferrer",className:"block p-3 rounded-lg bg-gray-50 hover:bg-indigo-50 cursor-pointer transition-colors",children:[(0,b.jsx)("p",{className:"text-xs font-medium text-gray-900 leading-snug line-clamp-2",children:a.title}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-1.5",children:[(0,b.jsx)("span",{className:"text-xs text-gray-400",children:a.source}),(0,b.jsxs)("span",{className:"text-xs text-indigo-500 font-medium",children:[a.relevance_score,"%"]})]})]},a.id))})]})]}),G&&(0,b.jsxs)("div",{className:"fixed bottom-4 right-4 z-50 max-w-sm bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl shadow-lg flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm flex-1",children:G}),(0,b.jsx)("button",{onClick:()=>H(null),className:"text-red-400 hover:text-red-600 cursor-pointer shrink-0",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,b.jsx)(g.default,{isOpen:y,onClose:()=>z(!1),title:"Subject Line Suggestions",children:(0,b.jsxs)("div",{className:"space-y-2",children:[u.map((a,c)=>(0,b.jsx)("div",{className:"px-4 py-3 rounded-xl border border-gray-200 hover:border-indigo-300 hover:bg-indigo-50 transition-colors cursor-pointer text-sm text-gray-900",onClick:()=>{navigator.clipboard.writeText(a),z(!1)},children:a},c)),(0,b.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"Click to copy to clipboard"})]})}),(0,b.jsx)(g.default,{isOpen:A,onClose:()=>B(!1),title:"Publish Newsletter",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"Choose a platform to publish:"}),["beehiiv","substack","kit"].map(a=>(0,b.jsx)("button",{onClick:()=>K(a),disabled:C,className:"w-full text-left px-4 py-3 rounded-xl border border-gray-200 hover:border-indigo-300 hover:bg-indigo-50 transition-colors cursor-pointer disabled:opacity-50",children:(0,b.jsx)("span",{className:"text-sm font-medium text-gray-900 capitalize",children:a})},a))]})})]}):(0,b.jsxs)("div",{className:"text-center py-16",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Draft not found"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"This draft may have been deleted."}),(0,b.jsx)(e.default,{onClick:()=>r.push("/dashboard/drafts"),children:"Back to Drafts"})]})}function l({params:a}){let{id:d}=(0,c.use)(a);return(0,b.jsx)(k,{draftId:d})}a.s(["default",()=>l],50276)}];

//# sourceMappingURL=Desktop_Projects_LetterFlow_src_d8c357fa._.js.map