(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,21839,e=>{"use strict";e.s(["DRAFT_STATUS_MAP",0,{draft:{variant:"default",label:"Draft"},review:{variant:"warning",label:"In Review"},scheduled:{variant:"info",label:"Scheduled"},published:{variant:"success",label:"Published"}},"INTEREST_OPTIONS",0,["Technology","Business","Creator","Marketing","Finance","AI & ML","Design","Startup"],"PLATFORM_META",0,{beehiiv:{label:"Beehiiv",description:"Connect your Beehiiv account to publish directly",color:"bg-amber-500"},substack:{label:"Substack",description:"Publish newsletters to your Substack",color:"bg-orange-500"},kit:{label:"Kit (ConvertKit)",description:"Send newsletters via Kit email platform",color:"bg-blue-500"}},"TIMING",0,{DEBOUNCE_MS:2e3,SAVE_DISPLAY_MS:2e3,RSS_CACHE_SEC:3600}])},29084,e=>{"use strict";var t=e.i(40404);let r={default:"bg-gray-100 text-gray-700",success:"bg-green-100 text-green-700",warning:"bg-amber-100 text-amber-700",info:"bg-blue-100 text-blue-700",purple:"bg-indigo-100 text-indigo-700"};function s({children:e,variant:s="default",className:i=""}){return(0,t.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r[s]} ${i}`,children:e})}e.s(["default",()=>s])},14972,e=>{"use strict";var t=e.i(51156),r=e.i(60456);function s(){let e=(0,t.useMemo)(()=>(0,r.createBrowserSupabaseClient)(),[]),[s,i]=(0,t.useState)(null),[a,n]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{e.auth.getUser().then(({data:e})=>{i(e.user),n(!1)});let{data:{subscription:t}}=e.auth.onAuthStateChange((e,t)=>{i(t?.user??null)});return()=>t.unsubscribe()},[e]),{supabase:e,user:s,loading:a}}e.s(["useUser",()=>s])},98330,e=>{"use strict";var t=e.i(40404);let r={primary:"bg-gradient-to-r from-indigo-600 to-violet-600 text-white hover:from-indigo-700 hover:to-violet-700 shadow-md shadow-indigo-200 hover:shadow-lg hover:shadow-indigo-300 active:scale-[0.98]",secondary:"bg-white text-gray-700 border border-gray-200 hover:border-indigo-300 hover:text-indigo-600 shadow-sm hover:shadow-md active:scale-[0.98]",ghost:"text-gray-600 hover:text-indigo-600 hover:bg-indigo-50"},s={sm:"px-3.5 py-1.5 text-sm gap-1.5",md:"px-5 py-2.5 text-sm gap-2",lg:"px-7 py-3.5 text-base gap-2"};function i({variant:e="primary",size:i="md",className:a="",children:n,...l}){return(0,t.jsx)("button",{className:`inline-flex items-center justify-center font-semibold rounded-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer ${r[e]} ${s[i]} ${a}`,...l,children:n})}e.s(["default",()=>i])},12933,e=>{"use strict";var t=e.i(40404),r=e.i(51156);function s({isOpen:e,onClose:s,title:i,children:a}){return((0,r.useEffect)(()=>{let t=e=>{"Escape"===e.key&&s()};return e&&(document.addEventListener("keydown",t),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",t),document.body.style.overflow=""}},[e,s]),e)?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-gray-900/60 backdrop-blur-sm",onClick:s}),(0,t.jsxs)("div",{className:"relative w-full max-w-lg mx-4 bg-white rounded-2xl shadow-2xl border border-gray-200 max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:i}),(0,t.jsx)("button",{onClick:s,className:"p-1.5 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsx)("div",{className:"px-6 py-5",children:a})]})]}):null}e.s(["default",()=>s])},4540,e=>{"use strict";function t(e){let t=new Date(e),r=Math.floor((new Date().getTime()-t.getTime())/36e5);if(r<1)return"Just now";if(r<24)return`${r}h ago`;let s=Math.floor(r/24);return s<7?`${s}d ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function r(e){return e&&e.trim()?e.trim().split(/\s+/).filter(Boolean).length:0}e.s(["countWords",()=>r,"formatDate",()=>t])},86410,e=>{"use strict";var t=e.i(40404),r=e.i(51156),s=e.i(90498),i=e.i(98330),a=e.i(29084),n=e.i(12933),l=e.i(14972),o=e.i(21839),d=e.i(4540);function c({draftId:e}){let{draft:c,sourceArticles:u,loading:x,saveStatus:h,debouncedSave:m,updateStatus:g}=function(e){let{supabase:t,user:s}=(0,l.useUser)(),[i,a]=(0,r.useState)(null),[n,c]=(0,r.useState)([]),[u,x]=(0,r.useState)(!0),[h,m]=(0,r.useState)("idle"),[g,f]=(0,r.useState)(null),p=(0,r.useRef)(void 0),[b,v]=(0,r.useState)(0);(0,r.useEffect)(()=>{if(!s||!e)return;let r=!0;return(async()=>{try{let{data:i,error:n}=await t.from("drafts").select("*").eq("id",e).eq("user_id",s.id).single();if(!r)return;if(n)throw n;i&&a(i);let{data:l}=await t.from("draft_articles").select("*, articles(*)").eq("draft_id",e);if(!r)return;if(l){let e=l.map(e=>e.articles).filter(Boolean);c(e)}f(null)}catch(e){if(!r)return;f(e instanceof Error?e.message:"Failed to load draft")}finally{r&&x(!1)}})(),()=>{r=!1,p.current&&clearTimeout(p.current)}},[t,s,e,b]);let y=(0,r.useCallback)(async r=>{if(!e||!s)return;m("saving");let i=(0,d.countWords)(r);await t.from("drafts").update({content:r,word_count:i}).eq("id",e).eq("user_id",s.id),m("saved"),setTimeout(()=>m("idle"),o.TIMING.SAVE_DISPLAY_MS)},[t,e,s]),j=(0,r.useCallback)(e=>{p.current&&clearTimeout(p.current),p.current=setTimeout(()=>y(e),o.TIMING.DEBOUNCE_MS)},[y]);return{draft:i,sourceArticles:n,loading:u,error:g,saveStatus:h,saveDraft:y,debouncedSave:j,updateStatus:async r=>{s&&(await t.from("drafts").update({status:r}).eq("id",e).eq("user_id",s.id),a(e=>e?{...e,status:r}:null))},refresh:()=>{x(!0),v(e=>e+1)}}}(e),{user:f}=(0,l.useUser)(),p=(0,s.useRouter)(),[b,v]=(0,r.useState)(""),[y,j]=(0,r.useState)([]),[w,N]=(0,r.useState)(!1),[k,S]=(0,r.useState)(!1),[C,T]=(0,r.useState)(!1),[M,L]=(0,r.useState)(!1),[A,_]=(0,r.useState)(null),[E,B]=(0,r.useState)(null);(0,r.useEffect)(()=>{c?.content&&v(c.content)},[c?.content]),(0,r.useEffect)(()=>{c&&b!==c.content&&m(b)},[b,c,m]);let D=async()=>{if(c){N(!0),B(null);try{let e=await fetch("/api/subject-lines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:c.title,content:b})});if(!e.ok){let t=await e.json().catch(()=>({}));B(t.error||"Failed to generate subject lines");return}let t=await e.json();j(t.subjectLines||[]),S(!0)}finally{N(!1)}}},I=async e=>{if(b.trim()){_(e),B(null);try{let t=await fetch("/api/ai-transform",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,content:b})});if(!t.ok){let e=await t.json().catch(()=>({}));B(e.error||"AI transformation failed");return}let r=await t.json();"tldr"===e?v(r.result+"\n\n---\n\n"+b):v(r.result)}finally{_(null)}}},P=async e=>{if(f&&c){L(!0),B(null);try{let t=await fetch("/api/publish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({draftId:c.id,platform:e})});if(!t.ok){let e=await t.json().catch(()=>({}));B(e.error||"Failed to publish");return}await g("published"),T(!1),p.push("/dashboard/drafts")}finally{L(!1)}}};return x?(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6 h-[calc(100vh-10rem)]",children:[(0,t.jsx)("div",{className:"flex-1 bg-gray-100 rounded-xl animate-pulse"}),(0,t.jsx)("div",{className:"w-full lg:w-80 bg-gray-100 rounded-xl animate-pulse"})]}):c?(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6 h-[calc(100vh-10rem)]",children:[(0,t.jsxs)("div",{className:"flex-1 flex flex-col bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(a.default,{variant:o.DRAFT_STATUS_MAP[c.status]?.variant||"default",children:o.DRAFT_STATUS_MAP[c.status]?.label||c.status}),(0,t.jsxs)("span",{className:"text-sm text-gray-400",children:[(0,d.countWords)(b)," words"]}),"saving"===h&&(0,t.jsx)("span",{className:"text-xs text-amber-500",children:"Saving..."}),"saved"===h&&(0,t.jsx)("span",{className:"text-xs text-green-500",children:"Saved"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(i.default,{variant:"ghost",size:"sm",onClick:()=>p.push("/dashboard/drafts"),children:"Back"}),(0,t.jsxs)(i.default,{size:"sm",onClick:()=>T(!0),children:["Publish",(0,t.jsx)("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})]})]}),(0,t.jsx)("textarea",{value:b,onChange:e=>v(e.target.value),className:"flex-1 p-6 text-sm text-gray-800 leading-relaxed resize-none focus:outline-none font-mono",placeholder:"Start writing your newsletter..."})]}),(0,t.jsxs)("div",{className:"w-full lg:w-80 flex flex-col gap-4 shrink-0",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-4",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"AI Assist"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("button",{onClick:()=>I("rewrite"),disabled:null!==A,className:"w-full flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm text-left hover:bg-indigo-50 text-gray-700 hover:text-indigo-700 transition-colors cursor-pointer disabled:opacity-50",children:[(0,t.jsx)("svg",{className:"w-4 h-4 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"rewrite"===A?"Rewriting...":"Rewrite in my style"]}),(0,t.jsxs)("button",{onClick:()=>I("shorten"),disabled:null!==A,className:"w-full flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm text-left hover:bg-indigo-50 text-gray-700 hover:text-indigo-700 transition-colors cursor-pointer disabled:opacity-50",children:[(0,t.jsx)("svg",{className:"w-4 h-4 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h8m-8 6h16"})}),"shorten"===A?"Shortening...":"Make it shorter"]}),(0,t.jsxs)("button",{onClick:D,disabled:w,className:"w-full flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm text-left hover:bg-indigo-50 text-gray-700 hover:text-indigo-700 transition-colors cursor-pointer disabled:opacity-50",children:[(0,t.jsx)("svg",{className:"w-4 h-4 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),w?"Generating...":"Generate subject lines"]}),(0,t.jsxs)("button",{onClick:()=>I("tldr"),disabled:null!==A,className:"w-full flex items-center gap-2 px-3 py-2.5 rounded-lg text-sm text-left hover:bg-indigo-50 text-gray-700 hover:text-indigo-700 transition-colors cursor-pointer disabled:opacity-50",children:[(0,t.jsx)("svg",{className:"w-4 h-4 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"tldr"===A?"Generating...":"Add TL;DR summary"]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-4 flex-1 overflow-auto",children:[(0,t.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:["Source Articles (",u.length,")"]}),0===u.length?(0,t.jsx)("p",{className:"text-xs text-gray-400",children:"No source articles linked to this draft."}):(0,t.jsx)("div",{className:"space-y-3",children:u.map(e=>(0,t.jsxs)("a",{href:e.source_url,target:"_blank",rel:"noopener noreferrer",className:"block p-3 rounded-lg bg-gray-50 hover:bg-indigo-50 cursor-pointer transition-colors",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-gray-900 leading-snug line-clamp-2",children:e.title}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1.5",children:[(0,t.jsx)("span",{className:"text-xs text-gray-400",children:e.source}),(0,t.jsxs)("span",{className:"text-xs text-indigo-500 font-medium",children:[e.relevance_score,"%"]})]})]},e.id))})]})]}),E&&(0,t.jsxs)("div",{className:"fixed bottom-4 right-4 z-50 max-w-sm bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl shadow-lg flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-sm flex-1",children:E}),(0,t.jsx)("button",{onClick:()=>B(null),className:"text-red-400 hover:text-red-600 cursor-pointer shrink-0",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsx)(n.default,{isOpen:k,onClose:()=>S(!1),title:"Subject Line Suggestions",children:(0,t.jsxs)("div",{className:"space-y-2",children:[y.map((e,r)=>(0,t.jsx)("div",{className:"px-4 py-3 rounded-xl border border-gray-200 hover:border-indigo-300 hover:bg-indigo-50 transition-colors cursor-pointer text-sm text-gray-900",onClick:()=>{navigator.clipboard.writeText(e),S(!1)},children:e},r)),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-2",children:"Click to copy to clipboard"})]})}),(0,t.jsx)(n.default,{isOpen:C,onClose:()=>T(!1),title:"Publish Newsletter",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"Choose a platform to publish:"}),["beehiiv","substack","kit"].map(e=>(0,t.jsx)("button",{onClick:()=>P(e),disabled:M,className:"w-full text-left px-4 py-3 rounded-xl border border-gray-200 hover:border-indigo-300 hover:bg-indigo-50 transition-colors cursor-pointer disabled:opacity-50",children:(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900 capitalize",children:e})},e))]})})]}):(0,t.jsxs)("div",{className:"text-center py-16",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"Draft not found"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"This draft may have been deleted."}),(0,t.jsx)(i.default,{onClick:()=>p.push("/dashboard/drafts"),children:"Back to Drafts"})]})}function u({params:e}){let{id:s}=(0,r.use)(e);return(0,t.jsx)(c,{draftId:s})}e.s(["default",()=>u],86410)}]);