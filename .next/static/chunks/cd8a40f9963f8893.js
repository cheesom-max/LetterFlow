(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,29084,e=>{"use strict";var t=e.i(40404);let r={default:"bg-gray-100 text-gray-700",success:"bg-green-100 text-green-700",warning:"bg-amber-100 text-amber-700",info:"bg-blue-100 text-blue-700",purple:"bg-indigo-100 text-indigo-700"};function s({children:e,variant:s="default",className:i=""}){return(0,t.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r[s]} ${i}`,children:e})}e.s(["default",()=>s])},14972,e=>{"use strict";var t=e.i(51156),r=e.i(60456);function s(){let e=(0,t.useMemo)(()=>(0,r.createBrowserSupabaseClient)(),[]),[s,i]=(0,t.useState)(null),[a,n]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{e.auth.getUser().then(({data:e})=>{i(e.user),n(!1)});let{data:{subscription:t}}=e.auth.onAuthStateChange((e,t)=>{i(t?.user??null)});return()=>t.unsubscribe()},[e]),{supabase:e,user:s,loading:a}}e.s(["useUser",()=>s])},98330,e=>{"use strict";var t=e.i(40404);let r={primary:"bg-gradient-to-r from-indigo-600 to-violet-600 text-white hover:from-indigo-700 hover:to-violet-700 shadow-md shadow-indigo-200 hover:shadow-lg hover:shadow-indigo-300 active:scale-[0.98]",secondary:"bg-white text-gray-700 border border-gray-200 hover:border-indigo-300 hover:text-indigo-600 shadow-sm hover:shadow-md active:scale-[0.98]",ghost:"text-gray-600 hover:text-indigo-600 hover:bg-indigo-50"},s={sm:"px-3.5 py-1.5 text-sm gap-1.5",md:"px-5 py-2.5 text-sm gap-2",lg:"px-7 py-3.5 text-base gap-2"};function i({variant:e="primary",size:i="md",className:a="",children:n,...o}){return(0,t.jsx)("button",{className:`inline-flex items-center justify-center font-semibold rounded-xl transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer ${r[e]} ${s[i]} ${a}`,...o,children:n})}e.s(["default",()=>i])},12933,e=>{"use strict";var t=e.i(40404),r=e.i(51156);function s({isOpen:e,onClose:s,title:i,children:a}){return((0,r.useEffect)(()=>{let t=e=>{"Escape"===e.key&&s()};return e&&(document.addEventListener("keydown",t),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",t),document.body.style.overflow=""}},[e,s]),e)?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-gray-900/60 backdrop-blur-sm",onClick:s}),(0,t.jsxs)("div",{className:"relative w-full max-w-lg mx-4 bg-white rounded-2xl shadow-2xl border border-gray-200 max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:i}),(0,t.jsx)("button",{onClick:s,className:"p-1.5 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsx)("div",{className:"px-6 py-5",children:a})]})]}):null}e.s(["default",()=>s])},4540,e=>{"use strict";function t(e){let t=new Date(e),r=Math.floor((new Date().getTime()-t.getTime())/36e5);if(r<1)return"Just now";if(r<24)return`${r}h ago`;let s=Math.floor(r/24);return s<7?`${s}d ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function r(e){return e&&e.trim()?e.trim().split(/\s+/).filter(Boolean).length:0}e.s(["countWords",()=>r,"formatDate",()=>t])},92735,e=>{"use strict";var t=e.i(51156),r=e.i(14972);function s(){let{supabase:e,user:s}=(0,r.useUser)(),[i,a]=(0,t.useState)([]),[n,o]=(0,t.useState)(!0),[l,d]=(0,t.useState)(null),[c,u]=(0,t.useState)(0);(0,t.useEffect)(()=>{if(!s)return;let t=!0;return(async()=>{try{let{data:r,error:i}=await e.from("topics").select("*, articles(count)").eq("user_id",s.id).order("created_at",{ascending:!1});if(!t)return;if(i)throw i;let n=(r||[]).map(e=>({...e,article_count:e.articles?e.articles[0]?.count??0:0}));a(n),d(null)}catch(e){if(!t)return;d(e instanceof Error?e.message:"Failed to load topics")}finally{t&&o(!1)}})(),()=>{t=!1}},[e,s,c]);let m=(0,t.useCallback)(()=>{o(!0),u(e=>e+1)},[]);return{topics:i,loading:n,error:l,addTopic:async t=>{if(!s)return;let{error:r}=await e.from("topics").insert({user_id:s.id,...t});return r||m(),r},updateTopic:async(t,r)=>{if(!s)return;let{error:i}=await e.from("topics").update(r).eq("id",t).eq("user_id",s.id);return i||m(),i},deleteTopic:async t=>{if(!s)return;let{error:r}=await e.from("topics").delete().eq("id",t).eq("user_id",s.id);return r||m(),r},refresh:m}}e.s(["useTopics",()=>s])},25430,e=>{"use strict";var t=e.i(40404),r=e.i(51156),s=e.i(90498),i=e.i(98330),a=e.i(11079),n=e.i(29084),o=e.i(4540);function l({article:e,onBookmark:r,onAddToDraft:s}){let i=e.relevance_score>=90?"from-emerald-500 to-teal-500 text-white":e.relevance_score>=80?"from-blue-500 to-cyan-500 text-white":"from-gray-100 to-gray-200 text-gray-600";return(0,t.jsxs)("div",{className:"group bg-white rounded-2xl border border-gray-100 shadow-sm p-5 hover:shadow-lg hover:border-indigo-100 transition-all duration-300",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2.5",children:[(0,t.jsx)(n.default,{variant:"purple",children:e.topic_name||"Uncategorized"}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:e.published_at?(0,o.formatDate)(e.published_at):""})]}),(0,t.jsx)("h3",{className:"text-base font-bold text-gray-900 leading-snug group-hover:text-indigo-700 transition-colors",children:e.title}),(0,t.jsx)("p",{className:"mt-2 text-sm text-gray-500 leading-relaxed line-clamp-2",children:e.summary}),(0,t.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-4 h-4 bg-gray-100 rounded-full"}),(0,t.jsx)("span",{className:"text-xs font-medium text-gray-500",children:e.source})]})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2 shrink-0",children:[(0,t.jsx)("div",{className:`w-13 h-13 rounded-xl bg-gradient-to-br ${i} flex items-center justify-center shadow-md`,children:(0,t.jsx)("span",{className:"text-sm font-extrabold",children:e.relevance_score})}),(0,t.jsx)("button",{onClick:()=>r(e.id),className:`p-1.5 rounded-lg transition-all cursor-pointer ${e.is_bookmarked?"text-indigo-600 bg-indigo-50":"text-gray-300 hover:text-indigo-400 hover:bg-indigo-50"}`,children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:e.is_bookmarked?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})})})]})]}),(0,t.jsxs)("div",{className:"mt-4 pt-3 border-t border-gray-50 flex items-center gap-1.5",children:[(0,t.jsx)("button",{onClick:()=>s?.(e.id),className:"text-xs font-medium px-3 py-1.5 rounded-lg transition-all text-gray-500 hover:text-indigo-600 hover:bg-indigo-50 cursor-pointer",children:"Add to Draft"}),(0,t.jsx)("a",{href:e.source_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs font-medium px-3 py-1.5 rounded-lg transition-all text-gray-500 hover:text-indigo-600 hover:bg-indigo-50",children:"View Original"})]})]})}var d=e.i(12933),c=e.i(14972),u=e.i(92735);function m(){let{articles:e,categories:n,loading:o,filters:m,setFilters:x,toggleBookmark:h,curate:g,curateLoading:f}=function(){let{supabase:e,user:t}=(0,c.useUser)(),[s,i]=(0,r.useState)([]),[a,n]=(0,r.useState)([]),[o,l]=(0,r.useState)(!0),[d,u]=(0,r.useState)({category:"All",search:""}),[m,x]=(0,r.useState)(!1),[h,g]=(0,r.useState)(null),[f,p]=(0,r.useState)(0);(0,r.useEffect)(()=>{if(!t)return;let r=!0;return(async()=>{try{let s=e.from("articles").select("*, topics(name, category)").eq("user_id",t.id).order("relevance_score",{ascending:!1});d.search&&(s=s.ilike("title",`%${d.search}%`));let{data:a,error:o}=await s;if(!r)return;if(o)throw o;let l=(a||[]).map(e=>{let t=e.topics;return{...e,topic_name:t?.name??"",_category:t?.category??""}}),c=[...new Set(l.map(e=>e._category).filter(Boolean))];n(c),"All"!==d.category&&(l=l.filter(e=>e._category===d.category)),i(l),g(null)}catch(e){if(!r)return;g(e instanceof Error?e.message:"Failed to load articles")}finally{r&&l(!1)}})(),()=>{r=!1}},[e,t,d,f]);let y=(0,r.useCallback)(()=>{l(!0),p(e=>e+1)},[]),b=async r=>{let a=s.find(e=>e.id===r);if(!a||!t)return;i(e=>e.map(e=>e.id===r?{...e,is_bookmarked:!e.is_bookmarked}:e));let{error:n}=await e.from("articles").update({is_bookmarked:!a.is_bookmarked}).eq("id",r).eq("user_id",t.id);n&&i(e=>e.map(e=>e.id===r?{...e,is_bookmarked:a.is_bookmarked}:e))};return{articles:s,categories:a,loading:o,error:h,filters:d,setFilters:u,toggleBookmark:b,curate:async e=>{if(t){x(!0),g(null);try{let t=await fetch("/api/curate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({topicId:e})});if(!t.ok){let e=await t.json().catch(()=>({}));g(e.error||"Failed to curate articles");return}y()}finally{x(!1)}}},curateLoading:m,refresh:y}}(),{topics:p}=(0,u.useTopics)(),{user:y}=(0,c.useUser)(),b=(0,s.useRouter)(),[v,j]=(0,r.useState)(""),[w,N]=(0,r.useState)(!1),[k,C]=(0,r.useState)([]),[_,S]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=setTimeout(()=>{x(e=>({...e,search:v}))},300);return()=>clearTimeout(e)},[v,x]);let T=async e=>{N(!1),await g(e)},L=async()=>{if(!y||0===k.length)return;S(null);let e=await fetch("/api/generate-draft",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({articleIds:k})});if(!e.ok)return void S((await e.json().catch(()=>({}))).error||"Failed to generate draft");let{draft:t}=await e.json();b.push(`/dashboard/drafts/${t.id}`)},M=e=>{C(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},A=["All",...n];return o?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"h-5 w-48 bg-gray-200 rounded animate-pulse"}),(0,t.jsx)("div",{className:"h-10 w-32 bg-gray-200 rounded-xl animate-pulse"})]}),(0,t.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,t.jsx)("div",{className:"h-40 bg-gray-100 rounded-2xl animate-pulse"},e))})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,t.jsx)("div",{children:(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[e.length," articles curated"]})}),(0,t.jsxs)("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[(0,t.jsx)("div",{className:"flex-1 sm:w-64",children:(0,t.jsx)(a.default,{placeholder:"Filter articles...",value:v,onChange:e=>j(e.target.value),icon:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})}),(0,t.jsxs)(i.default,{onClick:()=>N(!0),disabled:f,children:[(0,t.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),f?"Curating...":"Refresh"]})]})]}),_&&(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-sm flex-1",children:_}),(0,t.jsx)("button",{onClick:()=>S(null),className:"text-red-400 hover:text-red-600 cursor-pointer",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:A.map(e=>(0,t.jsx)("button",{onClick:()=>x(t=>({...t,category:e})),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors cursor-pointer ${m.category===e?"bg-indigo-600 text-white":"bg-white text-gray-600 border border-gray-200 hover:border-indigo-300 hover:text-indigo-600"}`,children:e},e))}),k.length>0&&(0,t.jsxs)("div",{className:"flex items-center justify-between bg-indigo-50 border border-indigo-200 rounded-xl px-4 py-3",children:[(0,t.jsxs)("span",{className:"text-sm font-medium text-indigo-700",children:[k.length," article",k.length>1?"s":""," selected"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(i.default,{variant:"ghost",size:"sm",onClick:()=>C([]),children:"Clear"}),(0,t.jsx)(i.default,{size:"sm",onClick:L,children:"Generate Draft"})]})]}),0===e.length?(0,t.jsxs)("div",{className:"text-center py-16",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-indigo-50 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("svg",{className:"w-8 h-8 text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"})})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:"No articles yet"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"Run AI curation on a topic to start discovering content."}),(0,t.jsx)(i.default,{onClick:()=>N(!0),children:"Run AI Curation"})]}):(0,t.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,t.jsx)(l,{article:e,onBookmark:h,onAddToDraft:M},e.id))}),(0,t.jsx)(d.default,{isOpen:w,onClose:()=>N(!1),title:"Select Topic to Curate",children:0===p.length?(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"No topics available. Add a topic first."}):(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"Choose a topic to fetch and analyze new articles:"}),p.filter(e=>e.is_active).map(e=>(0,t.jsxs)("button",{onClick:()=>T(e.id),className:"w-full text-left px-4 py-3 rounded-xl border border-gray-200 hover:border-indigo-300 hover:bg-indigo-50 transition-colors cursor-pointer",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,t.jsx)("span",{className:"ml-2 text-xs text-gray-400",children:e.keywords.slice(0,3).join(", ")})]},e.id))]})})]})}e.s(["default",()=>m],25430)}]);